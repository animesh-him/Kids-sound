<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Listen & Tap ‚Äî Multilingual (Levels + Spoken Start/End)</title>
<style>
  *,*::before,*::after{ box-sizing:border-box }
  html,body{ height:100% }
  body{ margin:0; overflow-x:hidden; font-family:system-ui,Segoe UI,Arial; background:#fff7f0; color:#222 }
  .wrap{ max-width:1000px; width:100%; margin:0 auto; padding:12px }
  .langbar{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:8px 0 }
  .lbtn{ border:1px solid #1f2937; background:#fff; color:#111827; padding:8px 14px; border-radius:999px; cursor:pointer; font-weight:700; letter-spacing:.02em }
  .lbtn.active{ background:#111827; color:#fff; border-color:#111827 }
  .hud{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:8px 0 }
  .pill{ background:#f3f3f3; padding:8px 12px; border-radius:16px; display:inline-flex; gap:8px; align-items:center }
  .btn{ border:0; border-radius:999px; padding:10px 16px; font-weight:700; cursor:pointer; background:#111827; color:#fff }
  .levelbar{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:8px 0 }
  .lvlbtn{ border:1px solid #78350f; background:#fff; color:#78350f; padding:8px 14px; border-radius:12px; cursor:pointer; font-weight:800; letter-spacing:.02em }
  .lvlbtn.active{ background:#78350f; color:#fff; }
  .grid{ display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:10px; width:100% }
  @media (min-width:760px){ .grid{ grid-template-columns:repeat(4, minmax(0,1fr)) } }
  .cell{ width:100%; border:1px solid #ddd; border-radius:12px; padding:22px 12px; min-height:86px; display:flex; align-items:center; justify-content:center; position:relative; font-size:26px }
  .label3d{ font-weight:900; letter-spacing:.03em; text-transform:uppercase }
  .label3d.white{ color:#fff; text-shadow:0 1px 0 rgba(0,0,0,.25),0 2px 0 rgba(0,0,0,.2),0 3px 0 rgba(0,0,0,.15),0 4px 0 rgba(0,0,0,.1),0 6px 6px rgba(0,0,0,.35) }
  .label3d.black{ color:#111; text-shadow:0 1px 0 rgba(255,255,255,.45),0 2px 0 rgba(255,255,255,.35),0 3px 0 rgba(255,255,255,.25),0 4px 0 rgba(255,255,255,.15),0 6px 6px rgba(0,0,0,.2) }
  .muted{ color:#666 }
  footer.smallnote{ margin-top:14px; color:#666; font-size:13px; line-height:1.35 }
</style>
<body>
<div class="wrap">
  <h1>üëÇ Listen & Tap ‚Äî Multilingual (Levels)</h1>
  <p class="muted">Level 1 shows <b>3D English labels</b> on color blocks; Level 2 uses <b>pure color blocks</b>. Spoken prompts use the selected language.</p>

  <div class="langbar" id="langbar"></div>

  <div class="levelbar">
    <button class="lvlbtn active" id="lvl1">Level 1 (Labels)</button>
    <button class="lvlbtn" id="lvl2">Level 2 (No Labels)</button>
  </div>

  <div class="hud">
    <span class="pill">Score: <b id="s">0</b></span>
    <span class="pill">‚è±Ô∏è <b id="t">60</b>s</span>
    <button class="btn" id="say">üó£Ô∏è Speak</button>
    <button class="btn" id="start">Start</button>
    <button class="btn" id="mute">üîä Sound: On</button>
  </div>

  <div id="grid" class="grid"></div>
  <p id="status" class="pill">Status: Press Start to begin ‚Äî <b>Let‚Äôs play, gently tap on me!</b></p>

  <footer class="smallnote">
    ‚ÑπÔ∏è If you install <b>Google Speech Services</b> and add Bengali, Gujarati, Spanish, etc. as a <i>system language</i>, Chrome can use a native voice.<br>
    üí¨ If you don‚Äôt see your language available, comment on the Games webpage ‚Äî I will include it. Have fun!
  </footer>
</div>

<script>
/* === Colors === */
var COLORS=[['red','#e63946'],['blue','#277da1'],['green','#2a9d8f'],['yellow','#ffd166'],['orange','#f4a261'],['pink','#ff6ea9'],['brown','#8d5524'],['black','#111111'],['white','#eeeeee'],['violet','#7F00FF'],['indigo','#4B0082']];

/* === Languages: English first, others A‚ÄìZ; UK English priority === */
var BASE_LANGS=[
  ['en','English',['en-GB','en-US','en-IN','en']],
  ['as','Assamese',['as-IN','as']], ['bn','Bengali',['bn-IN','bn-BD','bn']],
  ['de','German',['de-DE','de']], ['es','Spanish',['es-ES','es-MX','es']],
  ['fr','French',['fr-FR','fr']], ['gu','Gujarati',['gu-IN','gu']],
  ['hi','Hindi',['hi-IN','hi']], ['ja','Japanese',['ja-JP','ja']],
  ['kn','Kannada',['kn-IN','kn']], ['ko','Korean',['ko-KR','ko']],
  ['ml','Malayalam',['ml-IN','ml']], ['mr','Marathi',['mr-IN','mr']],
  ['or','Odia',['or-IN','or']], ['pa','Punjabi',['pa-IN','pa']],
  ['ta','Tamil',['ta-IN','ta']], ['te','Telugu',['te-IN','te']]
];
var LANG_CANDIDATES=(function(){var en=BASE_LANGS.find(x=>x[0]==='en');var others=BASE_LANGS.filter(x=>x[0]!=='en').sort((a,b)=>a[1].localeCompare(b[1]));return [en].concat(others);})();

/* === Localized names for speech === */
var L10N={
  en:{red:'red',blue:'blue',green:'green',yellow:'yellow',orange:'orange',pink:'pink',brown:'brown',black:'black',white:'white',violet:'violet',indigo:'indigo'},
  bn:{ red:'‡¶≤‡¶æ‡¶≤', blue:'‡¶®‡ßÄ‡¶≤', green:'‡¶∏‡¶¨‡ßÅ‡¶ú', yellow:'‡¶π‡¶≤‡ßÅ‡¶¶', orange:'‡¶ï‡¶Æ‡¶≤‡¶æ', pink:'‡¶ó‡ßã‡¶≤‡¶æ‡¶™‡¶ø', brown:'‡¶¨‡¶æ‡¶¶‡¶æ‡¶Æ‡ßÄ', black:'‡¶ï‡¶æ‡¶≤‡ßã', white:'‡¶∏‡¶æ‡¶¶‡¶æ', violet:'‡¶ú‡¶æ‡¶Æ‡ßÅ‡¶®‡¶ø', indigo:'‡¶®‡ßÄ‡¶≤‡¶ö‡ßá' },
  hi:{red:'‡§≤‡§æ‡§≤',blue:'‡§®‡•Ä‡§≤‡§æ',green:'‡§π‡§∞‡§æ',yellow:'‡§™‡•Ä‡§≤‡§æ',orange:'‡§®‡§æ‡§∞‡§Ç‡§ó‡•Ä',pink:'‡§ó‡•Å‡§≤‡§æ‡§¨‡•Ä',brown:'‡§≠‡•Ç‡§∞‡§æ',black:'‡§ï‡§æ‡§≤‡§æ',white:'‡§∏‡§´‡•á‡§¶',violet:'‡§ú‡§æ‡§Æ‡•Å‡§®‡•Ä',indigo:'‡§®‡•Ä‡§≤'},
  kn:{red:'‡≤ï‡≥Ü‡≤Ç‡≤™‡≥Å',blue:'‡≤®‡≥Ä‡≤≤‡≤ø',green:'‡≤π‡≤∏‡≤ø‡≤∞‡≥Å',yellow:'‡≤π‡≤≥‡≤¶‡≤ø',orange:'‡≤ï‡≤ø‡≤§‡≥ç‡≤§‡≤≥‡≥Ü',pink:'‡≤ó‡≥Å‡≤≤‡≤æ‡≤¨‡≤ø',brown:'‡≤ï‡≤Ç‡≤¶‡≥Å',black:'‡≤ï‡≤™‡≥ç‡≤™‡≥Å',white:'‡≤¨‡≤ø‡≤≥‡≤ø',violet:'‡≤µ‡≤Ø‡≥ä‡≤≤‡≥Ü‡≤ü‡≥ç',indigo:'‡≤á‡≤Ç‡≤°‡≤ø‡≤ó‡≥ã'},
  ta:{red:'‡Æö‡Æø‡Æµ‡Æ™‡Øç‡Æ™‡ØÅ',blue:'‡Æ®‡ØÄ‡Æ≤‡ÆÆ‡Øç',green:'‡Æ™‡Æö‡Øç‡Æö‡Øà',yellow:'‡ÆÆ‡Æû‡Øç‡Æö‡Æ≥‡Øç',orange:'‡ÆÜ‡Æ∞‡Æû‡Øç‡Æö‡ØÅ',pink:'‡Æá‡Æ≥‡Æû‡Øç‡Æö‡Æø‡Æµ‡Æ™‡Øç‡Æ™‡ØÅ',brown:'‡Æ™‡Æ¥‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ',black:'‡Æï‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ',white:'‡Æµ‡ØÜ‡Æ≥‡Øç‡Æ≥‡Øà',violet:'‡Æµ‡Øà‡Æ≤‡ØÜ‡Æü‡Øç',indigo:'‡Æá‡Æ£‡Øç‡Æü‡Æø‡Æï‡Øã'},
  te:{red:'‡∞é‡∞∞‡±Å‡∞™‡±Å',blue:'‡∞®‡±Ä‡∞≤‡∞Ç',green:'‡∞Ü‡∞ï‡±Å‡∞™‡∞ö‡±ç‡∞ö',yellow:'‡∞™‡∞∏‡±Å‡∞™‡±Å',orange:'‡∞®‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ú',pink:'‡∞ó‡±Å‡∞≤‡∞æ‡∞¨‡±Ä',brown:'‡∞ó‡±ã‡∞ß‡±Å‡∞Æ',black:'‡∞®‡∞≤‡±Å‡∞™‡±Å',white:'‡∞§‡±Ü‡∞≤‡±Å‡∞™‡±Å',violet:'‡∞µ‡∞Ø‡±ä‡∞≤‡±Ü‡∞ü‡±ç',indigo:'‡∞á‡∞Ç‡∞°‡∞ø‡∞ó‡±ã'},
  gu:{red:'‡™≤‡™æ‡™≤',blue:'‡™µ‡™æ‡™¶‡™≥‡´Ä',green:'‡™≤‡´Ä‡™≤‡´ã',yellow:'‡™™‡´Ä‡™≥‡´ã',orange:'‡™®‡™æ‡™∞‡™Ç‡™ó‡´Ä',pink:'‡™™‡™ø‡™Ç‡™ï',brown:'‡™§‡™™‡™ñ‡´Ä‡™∞',black:'‡™ï‡™æ‡™≥‡´ã',white:'‡™∏‡™´‡´á‡™¶',violet:'‡™µ‡™æ‡™Ø‡´ã‡™≤‡´á‡™ü',indigo:'‡™á‡™®‡´ç‡™°‡™ø‡™ó‡´ã'},
  as:{ red:'‡¶≤‡¶æ‡¶≤', blue:'‡¶®‡ßÄ‡¶≤‡¶æ', green:'‡¶∏‡ßá‡¶â‡¶ú', yellow:'‡¶π‡¶≤‡ßÅ‡¶¶', orange:'‡¶ï‡¶Æ‡¶≤‡¶æ', pink:'‡¶ó‡ßã‡¶≤‡¶æ‡¶™‡ßÄ', brown:'‡¶¨‡¶æ‡¶¶‡¶æ‡¶Æ‡ßÄ', black:'‡¶ï‚Äô‡¶≤‡¶æ', white:'‡¶∏‡¶æ‡¶¶‡¶æ', violet:'‡¶¨‡ßá‡¶ó‡ßÅ‡¶®‡¶ø', indigo:'‡¶á‡¶£‡ßç‡¶°‡¶ø‡¶ó‡ßã' },
  ml:{ red:'‡¥ö‡µÅ‡¥µ‡¥™‡µç‡¥™‡µç', blue:'‡¥®‡µÄ‡¥≤', green:'‡¥™‡¥ö‡µç‡¥ö', yellow:'‡¥Æ‡¥û‡µç‡¥û', orange:'‡¥ì‡¥±‡¥û‡µç‡¥ö‡µç', pink:'‡¥™‡¥ø‡¥ô‡µç‡¥ï‡µç', brown:'‡¥§‡¥µ‡¥ø‡¥ü‡µç‡¥ü‡µç', black:'‡¥ï‡¥±‡µÅ‡¥™‡µç‡¥™‡µç', white:'‡¥µ‡µÜ‡¥≥‡µÅ‡¥™‡µç‡¥™‡µç', violet:'‡¥µ‡¥Ø‡¥≤‡¥±‡µç‡¥±‡µç', indigo:'‡¥á‡¥£‡µç‡¥ü‡¥ø‡¥ó‡µã' },
  pa:{ red:'‡®≤‡®æ‡®≤', blue:'‡®®‡©Ä‡®≤‡®æ', green:'‡®π‡®∞‡®æ', yellow:'‡®™‡©Ä‡®≤‡®æ', orange:'‡®®‡®æ‡®∞‡©∞‡®ó‡©Ä', pink:'‡®ó‡©Å‡®≤‡®æ‡®¨‡©Ä', brown:'‡®≠‡©Ç‡®∞‡®æ', black:'‡®ï‡®æ‡®≤‡®æ', white:'‡®ö‡®ø‡©±‡®ü‡®æ', violet:'‡®¨‡©à‡©∞‡®ó‡®®‡©Ä', indigo:'‡®á‡©∞‡®°‡®ø‡®ó‡©ã' },
  or:{ red:'‡¨≤‡¨æ‡¨≤', blue:'‡¨®‡≠Ä‡¨≥', green:'‡¨∏‡¨¨‡≠Å‡¨ú', yellow:'‡¨π‡¨≥‡¨¶‡¨ø‡¨Ü', orange:'‡¨ï‡¨Æ‡¨≥‡¨æ', pink:'‡¨ó‡≠ã‡¨≤‡¨æ‡¨™‡≠Ä', brown:'‡¨¨‡¨æ‡¨¶‡¨æ‡¨Æ‡≠Ä', black:'‡¨ï‡¨≥‡¨æ', white:'‡¨ß‡¨≥‡¨æ', violet:'‡¨¨‡¨á‡¨ó‡¨£‡≠Ä', indigo:'‡¨á‡¨£‡≠ç‡¨°‡¨ø‡¨ó‡≠ã' },
  mr:{ red:'‡§≤‡§æ‡§≤', blue:'‡§®‡§ø‡§≥‡§æ', green:'‡§π‡§ø‡§∞‡§µ‡§æ', yellow:'‡§™‡§ø‡§µ‡§≥‡§æ', orange:'‡§®‡§æ‡§∞‡§ø‡§Ç‡§ó‡•Ä', pink:'‡§ó‡•Å‡§≤‡§æ‡§¨‡•Ä', brown:'‡¶§‡§™‡§ï‡§ø‡§∞‡•Ä', black:'‡§ï‡§æ‡§≥‡§æ', white:'‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ', violet:'‡§ú‡§æ‡§Ç‡§≠‡§≥‡§æ', indigo:'‡§á‡§Ç‡§°‡§ø‡§ó‡•ã' },
  ja:{red:'Ëµ§',blue:'Èùí',green:'Á∑ë',yellow:'ÈªÑ',orange:'„Ç™„É¨„É≥„Ç∏',pink:'„Éî„É≥„ÇØ',brown:'Ëå∂Ëâ≤',black:'Èªí',white:'ÁôΩ',violet:'„Éê„Ç§„Ç™„É¨„ÉÉ„Éà',indigo:'„Ç§„É≥„Éá„Ç£„Ç¥'},
  de:{red:'rot',blue:'blau',green:'gr√ºn',yellow:'gelb',orange:'orange',pink:'rosa',brown:'braun',black:'schwarz',white:'wei√ü',violet:'violett',indigo:'indigo'},
  ko:{red:'Îπ®Í∞ï',blue:'ÌååÎûë',green:'Ï¥àÎ°ù',yellow:'ÎÖ∏Îûë',orange:'Ï£ºÌô©',pink:'Î∂ÑÌôç',brown:'Í∞àÏÉâ',black:'Í≤ÄÏ†ï',white:'ÌïòÏñë',violet:'Î∞îÏù¥Ïò¨Î†õ',indigo:'Ïù∏ÎîîÍ≥†'},
  fr:{red:'rouge',blue:'bleu',green:'vert',yellow:'jaune',orange:'orange',pink:'rose',brown:'marron',black:'noir',white:'blanc',violet:'violet',indigo:'indigo'},
  es:{red:'rojo',blue:'azul',green:'verde',yellow:'amarillo',orange:'naranja',pink:'rosa',brown:'marr√≥n',black:'negro',white:'blanco',violet:'violeta',indigo:'√≠ndigo'}
};

/* === Audio/Speech === */
var voices=[], voice=null, currentLang='en', soundOn=true;
function speak(text){
  if(!soundOn || !voice || !text) return;
  try{
    var u=new SpeechSynthesisUtterance(text);
    u.voice=voice; u.rate=1; u.pitch=1;
    window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);
  }catch(e){}
}
function nameFor(key){ var pack=L10N[currentLang]||L10N.en; return pack[key]||key; }

/* === Messages === */
var POSITIVE=["Brilliant!","Great job!","You nailed it!","Super!","Awesome move!","Fantastic!","Spot on!","You're on fire!","Nice pick!","Keep it up!","Well done!","Perfect!","Excellent!","Sharp eyes!","Love that focus!","Crushing it!","That‚Äôs the spirit!","Beautiful tap!","You‚Äôre unstoppable!","Champion energy!"];
var TRY_AGAIN=["Almost there‚Äîtry again!","So close!","Keep going‚Äîyou‚Äôve got this!","Good effort‚Äîtry once more!","No worries, next one!","Eyes on the prize!","You can do it!","Stay sharp!","Keep tapping‚Äîpractice wins!","One more try!","We learn by trying!","No problem‚Äînext one is yours!","Steady now, you‚Äôve got it!","Take a breath and go again!","It‚Äôs all practice‚Äîwell done!","Trust your eyes!","Great spirit!","Tap again with confidence!","Strong effort!","Keep the rhythm!"];
var END_LOW=["You are my buddy ‚ù§Ô∏è Let's play again, shall we?","Great try! Next round will be even better.","You did wonderful ‚Äî score doesn‚Äôt matter, fun does!","Cheer up champ! Let‚Äôs go again soon.","Every tap counts, you‚Äôre improving already!","You are awesome ‚Äî the score is just a number.","Keep shining, you‚Äôre my favorite player!","Smile! Games are for joy, not just points.","Fantastic spirit! Let‚Äôs try one more time.","High five ü§ö You played with heart!","Your energy is amazing ‚Äî keep tapping!","Friend, you‚Äôre building skills every round.","No worries ‚Äî we‚Äôre in this together!","You brighten the game ‚Äî keep going!","A little score, but a big heart!","The fun matters more than the score!","Play again? I‚Äôll cheer you louder!","Next time will be your round!","You‚Äôre a true buddy gamer!","Keep that smile, champion!"];
var END_HIGH=["Wow! You crushed it! üèÜ","Amazing score ‚Äî you‚Äôre a star!","Champion vibes only ‚ú® Keep it up!","Fantastic! That‚Äôs true focus.","You‚Äôre unstoppable ‚Äî what a round!","Incredible tapping skills üëè","Brilliant memory and speed!","Legendary score ‚Äî salute!","Excellent! You‚Äôve set a new bar.","Superb ‚Äî you made me proud!","Victory dance time üíÉüï∫","You‚Äôre glowing with success!","A masterpiece of tapping!","Bravo! A champion indeed.","High score, high spirit!","Unstoppable energy ‚Äî wow!","Keep rocking superstar!","That‚Äôs record-breaking speed!","Phenomenal! You inspire me!","Hall of fame performance!"];
function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

/* === Game state === */
var playing=false, secs=60, score=0, target=0, timer=null, level=1;
var grid=document.getElementById('grid'), statusEl=document.getElementById('status');
function updateStatus(m){ statusEl.textContent='Status: '+m; }
function shuffle(a){ for(var i=a.length-1;i>0;i--){ var j=Math.floor(Math.random()*(i+1)); var t=a[i]; a[i]=a[j]; a[j]=t; } return a; }
function labelTone(hex){ var r=parseInt(hex.substr(1,2),16),g=parseInt(hex.substr(3,2),16),b=parseInt(hex.substr(5,2),16); var L=0.2126*(r/255)+0.7152*(g/255)+0.0722*(b/255); return (L<0.55)?'white':'black'; }

/* === ONLY CHANGE BEGINS: Bengali MP3 when speaking color name === */
function speakColorKey(key, text){
  if(!text) text = (L10N[currentLang] && L10N[currentLang][key]) ? L10N[currentLang][key] : key;
  if(currentLang === 'bn' && soundOn){
    try{
      var audio = new Audio('animesh-him/audio/bn/' + key + '.mp3');
      var p = audio.play();
      if(p !== undefined){
        p.catch(function(){ speak(text); }); // fallback to TTS if file missing/blocked
      }
      return;
    }catch(e){
      speak(text); // fallback
      return;
    }
  }
  // All other languages unchanged ‚Üí TTS
  speak(text);
}
/* === ONLY CHANGE ENDS === */

function nextRound(){ target=Math.floor(Math.random()*COLORS.length); speakColorKey(COLORS[target][0], nameFor(COLORS[target][0])); rebuildTiles(); }
function rebuildTiles(){
  grid.innerHTML='';
  var order=shuffle(COLORS.slice());
  order.forEach(function(item){
    var key=item[0], bg=item[1], d=document.createElement('button');
    d.className='cell'; d.style.background=bg; d.style.borderColor='#00000020'; d.style.width='100%';
    if(level===1){
      var tone=labelTone(bg), span=document.createElement('span');
      span.className='label3d '+(tone==='white'?'white':'black');
      span.textContent=key.toUpperCase();
      d.appendChild(span);
    }
    d.onclick=function(){ choose(key===COLORS[target][0]); };
    grid.appendChild(d);
  });
}
function choose(ok){
  if(!playing) return;
  if(ok){ score++; document.getElementById('s').textContent=score; updateStatus('Score: '+score+' ‚Äî '+pick(POSITIVE)); nextRound(); }
  else  { score=Math.max(0,score-1); document.getElementById('s').textContent=score; updateStatus('Score: '+score+' ‚Äî '+pick(TRY_AGAIN)); }
}

/* === Controls === */
document.getElementById('say').onclick=function(){ if(playing) speakColorKey(COLORS[target][0], nameFor(COLORS[target][0])); };
document.getElementById('start').onclick=function(){
  playing=true; secs=60; score=0;
  document.getElementById('s').textContent=0; document.getElementById('t').textContent=secs;
  var startLine="Let‚Äôs play ‚Äî gently tap on me!";
  updateStatus("Game started. Language: "+readableLangLabel(currentLang, voice)+" ‚Ä¢ Score: 0 ‚Äî "+startLine);
  speak(startLine); // üîä start message stays TTS (all languages)
  nextRound();
  if(timer) clearInterval(timer);
  timer=setInterval(function(){
    secs--; document.getElementById('t').textContent=secs;
    if(secs<=0){
      clearInterval(timer); playing=false;
      var msg=(score<5?pick(END_LOW):pick(END_HIGH));
      var endLine="Time‚Äôs up! Final score: "+score+". "+msg;
      updateStatus("‚è∞ "+endLine);
      speak(endLine); // üîä end message stays TTS (all languages)
    }
  },1000);
};
document.getElementById('mute').onclick=function(e){ soundOn=!soundOn; e.target.textContent=soundOn?'üîä Sound: On':'üîá Sound: Off'; };
document.getElementById('lvl1').onclick=function(){ level=1; this.classList.add('active'); document.getElementById('lvl2').classList.remove('active'); if(playing) rebuildTiles(); updateStatus("Level 1 (Labels) selected. Let‚Äôs play, gently tap on me!"); };
document.getElementById('lvl2').onclick=function(){ level=2; this.classList.add('active'); document.getElementById('lvl1').classList.remove('active'); if(playing) rebuildTiles(); updateStatus("Level 2 (No Labels) selected. Let‚Äôs play, gently tap on me!"); };

/* === Language bar (voice-verified) === */
var langbar=document.getElementById('langbar');
function readableLangLabel(code,v){
  if(code==='en'&&v){ var L=(v.lang||'').toLowerCase();
    if(L.startsWith('en-gb')) return 'English (UK)';
    if(L.startsWith('en-us')) return 'English (US)';
    if(L.startsWith('en-in')) return 'English (India)';
    return 'English';
  }
  var f=LANG_CANDIDATES.find(x=>x[0]===code); return f?f[1]:code;
}
function refreshVoices(){
  try{ voices=window.speechSynthesis?window.speechSynthesis.getVoices():[]; }catch(e){ voices=[]; }
  langbar.innerHTML='';
  LANG_CANDIDATES.forEach(function(cfg){
    var code=cfg[0], label=cfg[1], tags=cfg[2];
    var v=voices.find(function(vc){ return tags.some(function(t){ return (vc.lang||'').toLowerCase().startsWith(t.toLowerCase()); }); });
    if(v){
      var b=document.createElement('button'); b.className='lbtn'; b.textContent=(code==='en')?'English':label; b.dataset.code=code;
      b.onclick=function(){
        currentLang=code; voice=v;
        Array.prototype.forEach.call(langbar.children,x=>x.classList.remove('active'));
        b.classList.add('active');
        updateStatus('Language: '+readableLangLabel(code,v)+' ‚Ä¢ Voice: '+(v.name||v.lang)+' ‚Ä¢ Score: '+score);
        if(playing) nextRound();
      };
      langbar.appendChild(b);
      if(code==='en' && !document.querySelector('.lbtn.active')){ b.classList.add('active'); currentLang='en'; voice=v; }
    }
  });
  updateStatus(langbar.children.length? 'Voices ready ('+langbar.children.length+' languages). Press Start!' : 'No compatible voices detected. You can still play by tapping colors.');
}
try{
  if(window.speechSynthesis){
    window.speechSynthesis.onvoiceschanged=refreshVoices;
    setTimeout(refreshVoices,200);
  }else{
    updateStatus('Speech synthesis not available in this browser.');
  }
}catch(e){ updateStatus('Speech init error.'); }
</script>
</body>
</html>
