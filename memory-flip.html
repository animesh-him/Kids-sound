<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Memory Flip ‚Äì Puja Icons</title>
<style>
  :root { color-scheme: light; }
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;background:#fff7f0;color:#222}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
  .card{aspect-ratio:1/1;border-radius:12px;display:grid;place-items:center;background:#c1121f;color:#fff;font-size:40px;user-select:none;cursor:pointer;outline:none}
  .card:focus{box-shadow:0 0 0 3px #2225}
  .open{background:#ffe3a3;color:#222}
  .pill{background:#f1f1f1;padding:8px 12px;border-radius:999px;display:inline-flex;gap:8px;align-items:center}
  .btn{border:0;border-radius:999px;padding:10px 16px;font-weight:700;cursor:pointer;background:#c1121f;color:#fff}
  .hud{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px}
  footer{margin-top:16px;color:#666;font-size:12px;text-align:center}
</style>
<body>
  <div class="wrap">
    <h1>üß† Memory Flip ‚Äì Puja Icons</h1>
    <p><b>Instruction:</b> Tap or press Enter/Space to flip cards and match pairs. <b>Fewer moves is better.</b></p>

    <div class="hud" role="region" aria-label="Game status and controls">
      <span class="pill">Moves: <b id="m" aria-live="polite">0</b></span>
      <span class="pill">üèÜ Best (fewest): <b id="b" aria-live="polite">‚Äî</b></span>
      <button id="start" class="btn" aria-label="Start or reset the game">Start</button>
      <button id="resetBest" class="btn" aria-label="Reset best score">Reset Best</button>
      <span class="pill" style="gap:6px">
        <button id="soundBtn" class="btn" aria-pressed="true">üîä Sound: On</button>
        <button id="speak" class="btn">üó£Ô∏è Speak</button>
      </span>
    </div>

    <div id="grid" class="grid" aria-label="Memory cards grid"></div>

    <footer>
      Created &amp; designed by <b>Animesh</b> ‚Ä¢ Works offline ‚Ä¢ No tracking
    </footer>
  </div>

  <script>
    // --- tiny sound helpers (gracefully degrade if blocked/unavailable) ---
    let AC = null, soundOn = true;
    function ensureAC(){
      try{
        if(!AC){ AC = new (window.AudioContext||window.webkitAudioContext)(); }
        if(AC && AC.state==='suspended'){ AC.resume(); }
      }catch(e){}
    }
    function beep(freq=880, dur=0.07, vol=0.08){
      try{
        if(!soundOn) return;
        ensureAC(); if(!AC) return;
        const o=AC.createOscillator(), g=AC.createGain();
        o.frequency.value=freq; o.type='sine'; g.gain.value=vol;
        o.connect(g); g.connect(AC.destination); o.start(); o.stop(AC.currentTime+dur);
      }catch(e){}
    }
    const blipGood = ()=>beep(920,0.08,0.10);
    const blipBad  = ()=>beep(220,0.10,0.10);
    const pop      = ()=>beep(660,0.05,0.12);

    function speakLine(text){
      try{
        if(!('speechSynthesis' in window)) return;
        const u=new SpeechSynthesisUtterance(text); u.lang='en-IN'; u.rate=1;
        window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);
      }catch(e){}
    }

    function toggleSound(btn){
      soundOn = !soundOn;
      if(btn){
        btn.textContent = soundOn ? 'üîä Sound: On' : 'üîá Sound: Off';
        btn.setAttribute('aria-pressed', soundOn ? 'true' : 'false');
      }
      try { localStorage.setItem('mf_sound', soundOn ? 'on' : 'off'); } catch(e){}
    }
  </script>

  <script>
    // --- game state ---
    const ICONS = ['ü™î','üïâÔ∏è','üéâ','ü•Å','ü™ò','ü™ô','üßß','üå∏'];
    let first = null, second = null, lock = false, moves = 0, matched = 0, best = Infinity;

    const grid = document.getElementById('grid');
    const m = document.getElementById('m');
    const b = document.getElementById('b');
    const btnStart = document.getElementById('start');
    const btnSpeak = document.getElementById('speak');
    const btnSound = document.getElementById('soundBtn');
    const btnResetBest = document.getElementById('resetBest');

    const guide = 'Flip two cards to find a matching pair. Try to remember where they are! Fewer moves is better.';

    btnSpeak.addEventListener('click',()=>speakLine(guide));
    btnSound.addEventListener('click',e=>toggleSound(e.currentTarget));

    // Persisted sound preference
    try {
      const s = localStorage.getItem('mf_sound');
      if (s === 'off') { soundOn = false; btnSound.textContent = 'üîá Sound: Off'; btnSound.setAttribute('aria-pressed','false'); }
      else { btnSound.setAttribute('aria-pressed','true'); }
    } catch(e){}

    // Load best (treat legacy 0/invalid as no best)
    try {
      const stored = Number(localStorage.getItem('mf_best'));
      if (Number.isFinite(stored) && stored > 0) best = stored;
    } catch(e) { best = Infinity; }
    b.textContent = Number.isFinite(best) ? best : '‚Äî';

    // Reduced-motion users: skip the hide delay
    const REDUCE_MOTION = window.matchMedia?.('(prefers-reduced-motion: reduce)').matches === true;

    // Start / reset board
    function start(){
      grid.innerHTML = '';
      moves = 0; matched = 0; first = null; second = null; lock = false;
      m.textContent = 0;
      speakLine(guide); blipGood();

      const deck = [...ICONS, ...ICONS].sort(()=>Math.random()-0.5);
      deck.forEach(sym=>{
        const c = document.createElement('div');
        c.className = 'card';
        c.dataset.sym = sym;
        c.textContent = '?';
        c.setAttribute('role','button');
        c.setAttribute('tabindex','0');
        c.setAttribute('aria-label','Hidden card');
        c.addEventListener('pointerdown', ()=>flip(c), {passive:true});
        c.addEventListener('keydown', (e)=>{
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); flip(c); }
        });
        grid.appendChild(c);
      });
      // Put focus on first card for keyboard users
      grid.firstElementChild?.focus();
    }

    // Flip logic
    function flip(c){
      if (lock || c.classList.contains('open')) return;

      c.classList.add('open');
      c.textContent = c.dataset.sym;
      c.setAttribute('aria-label', `Card showing ${c.dataset.sym}`);
      pop();

      if (!first){ first = c; return; }
      second = c; lock = true; moves++; m.textContent = moves;

      if (first.dataset.sym === second.dataset.sym){
        matched += 2; blipGood();
        first = null; second = null; lock = false;

        if (matched === ICONS.length * 2){
          if (moves < best){
            best = moves;
            try { localStorage.setItem('mf_best', String(best)); } catch(e){}
            b.textContent = best;
          }
          alert('Great memory! Moves: ' + moves);
        }
      } else {
        blipBad();
        const hide = ()=>{
          first.classList.remove('open'); second.classList.remove('open');
          first.textContent='?'; second.textContent='?';
          first.setAttribute('aria-label','Hidden card');
          second.setAttribute('aria-label','Hidden card');
          first = null; second = null; lock = false;
        };
        REDUCE_MOTION ? hide() : setTimeout(hide, 650);
      }
    }

    // Controls
    btnStart.addEventListener('click', start);
    btnResetBest.addEventListener('click', ()=>{
      try { localStorage.removeItem('mf_best'); } catch(e){}
      best = Infinity; b.textContent = '‚Äî';
      blipGood();
    });

    // Auto-start once (optional)
    // start();
  </script>
</body>
</html>
